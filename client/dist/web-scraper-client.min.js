var WebScraperClient;(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,u=void 0,u=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(u)?u:String(u)),o)}var i,u}e.d(t,{default:()=>s});var o=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.requestUrl=t,this._meta=r,this._queries=n}var t,r,o;return t=e,r=[{key:"meta",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null==t?this._meta:null!==(e=this._meta[t])&&void 0!==e?e:void 0}},{key:"queryValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!(e in this._queries))return t;var r=this._queries[e];return!1!==r.error||0>=r.values.length?t:r.values}},{key:"queryValue",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!==(t=this.queryValues(e,[])[0])&&void 0!==t?t:r}},{key:"queryError",value:function(e){return e in this._queries&&this._queries[e].error}}],r&&n(t.prototype,r),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}const s=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._scraperEndpoint=t;var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({storage:null,ttl:3600,prefix:"web-scraper-cache:"},"object"===i(r.cache)?r.cache:{});null!==n.storage&&"object"===i(n.storage)&&"function"==typeof n.storage.getItem&&"function"==typeof n.storage.setItem&&"function"==typeof n.storage.removeItem||(n.storage=null),this._options={cache:n}}var t,r,n;return t=e,r=[{key:"scrap",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="url=".concat(encodeURIComponent(e));"object"===i(r)&&0<Object.keys(r).length&&(n+="&queries=".concat(encodeURIComponent(JSON.stringify(r))));var u,a="".concat(this._scraperEndpoint,"?").concat(n),c=this._options.cache.storage;if(c){u=this._options.cache.prefix+a;var l=c.getItem(u);if(null!==(l="string"==typeof l?JSON.parse(l):null)&&(new Date).getTime()>l.expiration)c.removeItem(u);else if(null!==l){var s=l,f=s.requestUrl,p=s.meta,y=s.queries;return new Promise((function(e){e(new o(f,p,y))}))}}return fetch(a).then((function(e){return e.json()})).then((function(e){if("OK"!==e.status||!1!==e.error)throw new Error("".concat(e.status||"ERR",": ").concat(e.error||"Error"));var r=e.result,n=r.requestUrl,i=r.meta,a=r.queries;return c&&c.setItem(u,JSON.stringify({requestUrl:n,meta:i,queries:a,expiration:(new Date).getTime()+1e3*t._options.cache.ttl})),new o(n,i,a)}))}}],r&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();WebScraperClient=t.default})();